# 逻辑回归和最大熵模型
最大熵是概率模型学习的准则

逻辑回归和最大熵模型都是对数线性模型

## 逻辑回归
逻辑分布,μ 位置参数，γ > 0 形状参数
- ![分布函数](https://bkimg.cdn.bcebos.com/formula/d11416553201a4598727c0d9f03710db.svg)
- 标准分布函数，μ = 0，γ = 1
  - ![标准分布函数](https://bkimg.cdn.bcebos.com/formula/1b3a371c7b4f1cb2809cbb9da53a0415.svg)

分布函数

![分布函数](https://note.youdao.com/yws/api/personal/file/105EEFFA739E433FB6DA3E7FABA39B6B?method=download&shareKey=755d13b1346b2c2f2539b25bcac851a5)

密度函数

![密度函数](https://note.youdao.com/yws/api/personal/file/BC223D8CD9DE40A7B4382E75D50B3695?method=download&shareKey=55d6dbb829daf4939944917720169d16)

中心对称，两端慢，中间快

### 二项逻辑回归
用于分类。随机变量 Y 取 0 或 1

一个事件的几率是发生与不发生概率的比值
- 几率为 p/1-p
- 对数几率为 log(p/1-p)

定义逻辑回归条件概率分布：
- `P(Y=1|x) = exp(w·x) / (1 + exp(w·x))`
- `P(Y=0|x) = 1 / (1 + exp(w·x))`

带入对数几率 -> `log(p/1-p)` -> `log(exp(w·x))` -> `w·x`

逻辑回归中，Y = 1 的对数几率是输入 x 的线性函数

`P(Y=1|x) = exp(w·x) / (1 + exp(w·x))`
- w·x 为线性函数的值
- 接近正无穷，P = 1；接近负无穷，P = 0

### 参数估计
w 的值可以用极大似然估计

对对数似然函数求极大值，得到 w 的估计值，这样问题就变成了对对数似然函数为目标函数的最优化问题。
用拟牛顿法或者梯度下降法求解。

学习到的逻辑回归模型是
- `P(Y=1|x) = exp(w估·x) / (1 + exp(w估·x))`
- `P(Y=0|x) = 1 / (1 + exp(w估·x))`


## 最大熵模型
熵最大的模型是最好的模型
- `H(X) = -sum(pi·logpi)`
- `0 <= H(P) <= log|X|`,`|X|` 是 X 的取值个数
- X 服从均匀分布，熵最大 `H(P) = log|X|`

###  最大熵模型的思想
最大熵模型认为，学习概率模型时，在所有可能的概率模型中，熵最大的模型是最好的模型。
- 在预测一个样本或者一个事件的概率分布时，首先应当满足所有的约束条件，进而对未知的情况不做任何的主观假设
- 在这种情况下，概率分布最均匀，预测的风险最小，因此得到的概率分布的熵是最大。

假设随机变量X有5个取值{A,B,C,D,E}，如果约束条件为P(A)+ P(B)+ P(C)+ P(D)+ P(E)=1

在没有其他任何信息的情况下要估计各个值的概率时，我们只能估计为等概率，即P(A)=P(B)=P(C)=P(D)=P(E)=1/5。

### 最大熵模型的定义
给定训练数据集,可以确定联合分布P(X,Y)的经验分布
![经验分布](https://images2018.cnblogs.com/blog/1340182/201803/1340182-20180328154127295-1500038043.png)
和边缘分布P(X)的经验分布
![经验分布](https://images2018.cnblogs.com/blog/1340182/201803/1340182-20180328154141776-1634765352.png)

- v表示频数,N表示样本容量
- 用特征函数f(x,y)=1描述x与y满足某一事实，可以得到特征函数关于P(X,Y)的经验分布的期望值和关于模型P(Y|X)与P(X)的经验分布的期望值
- 假设两者相等,得到了约束条件

![约束条件](https://images2018.cnblogs.com/blog/1340182/201803/1340182-20180328154435423-22674055.png)

- 在条件概率分布P(Y|X)上的条件熵为

![条件熵](https://images2018.cnblogs.com/blog/1340182/201803/1340182-20180328154526636-172871135.png)

条件熵最大的模型称为最大熵模型